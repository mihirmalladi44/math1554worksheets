<?xml version="1.0" encoding="UTF-8"?>
    <worksheet>
      <title>26 The Singular Value Decomposition (LN 2.5, 2.6, 2.7)</title>

      <page>
        <p><m>\textbf{26.1 Singular Values}</m></p>

        <p>Consider the linear transformation whose standard matrix is</p>

        <me>
          A = 
          \begin{pmatrix}
          0 \amp -1 \\
          1 \amp 0
          \end{pmatrix}
          \begin{pmatrix}
          4 \amp 0 \\
          0 \amp 3
          \end{pmatrix}
          = 
          \begin{pmatrix}
          0 \amp -3 \\
          4 \amp 0
          \end{pmatrix}
        </me>

        <p>Then:</p>
        <ul>
          <li>The transform is a composition of a rotation and a scaling.</li>
          <li>Unit vectors in <m>\mathbb{R}^2</m> are mapped to an ellipse.</li>
        </ul>

        <image label="elliptical-26" width="100%">
              
              <latex-image>
                \begin{tikzpicture}[scale=0.8]
            \draw[->,gray] (-3,0) -- (3,0) node[right,black] {$x_1$};
            \draw[->,gray] (0,-3) -- (0,3) node[left,black] {$x_2$};
            \draw [rotate=0,black,very thick] (0,0) ellipse (30pt and 30pt);  
            \draw[->,thick,>=stealth,line width=0.75mm] (4.5,0) -- node[above] {multiply by $A$} ++ (4,0);
            \draw[->,gray] (9,0) -- (15,0) node[right,black] {$x_1$};
            \draw[->,gray] (12,-3) -- (12,3) node[left,black] {$x_2$};
            \draw [rotate=90,black,very thick] (0,-12) ellipse (70pt and 50pt);    
        \end{tikzpicture}
              </latex-image>
          </image>


        <p>Assume that the input <m>\vec{x}</m> satisfies <m>\|\vec{x}\| = 1</m>. Determine:</p>

        <ol marker="1.">
          <li>Determine the unit vector <m>\vec{x}</m> that maximizes <m>\|A \vec{x}\|</m>, and what <m>\|A \vec{v}_1\|</m> is equal to.</li>
          <li>Determine the unit vector <m>\vec{x}</m> that minimizes <m>\|A \vec{x}\|</m>, and what <m>\|A \vec{v}_2\|</m> is equal to.</li>
        </ol>
      </page>

      <page>
        <p><m>{\large \textbf{26.2 The Four Fundamental Subspaces}}</m></p>

        <p>The eigenvectors of <m>A^T A</m> can be used to construct bases for the four fundamental subspaces of any matrix.</p>

        <image label="two-rectangles-figure-26" width="50%">
              <latex-image>
                \begin{tikzpicture}[scale=.85]
        
                    % boxes
                    \filldraw[draw=DarkBlue!50,fill=DarkBlue!15] (0,0) -- (-1,1) -- (1,3) -- (2,2) -- cycle;
                    \filldraw[draw=DarkBlue!50,fill=DarkBlue!15] (0,0) -- (1,-1) -- (0,-2) -- (-1,-1) -- cycle;      
                    \draw (0.4, 1.7) node[below]{\small $\Row A$};2
                    \draw (0.0,-0.7) node[below]{\small $\Nul A$};        
                    
                    
                    \filldraw[draw=DarkGreen!50,fill=DarkGreen!15] (4,0) -- (2.5, 1.5) -- (3.5, 2.5) -- (5,1) -- cycle;
                    \filldraw[draw=DarkGreen!50,fill=DarkGreen!15] (4,0) -- (5.5,-1.5) -- (4.5,-2.5) -- (3,-1) -- cycle;        
                    \draw (3.9, 1.5) node[below]{\small $\Col A$};
                    \draw (4.2, -0.8) node[below]{\small $\Nul A^T$};        

                    \draw (-1.0,0.5) node[below]{\Large $\color{DarkBlue} \mathbb R^n$};

                    \draw ( 5.0,0.5) node[below]{\Large $\color{DarkGreen} \mathbb R^m$};
                    
                \end{tikzpicture}
              </latex-image>
          </image>

        <p><m>\textbf{Bases for Row(A) and Null(A)}</m></p>

        <p>Suppose <m>\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n</m> are the <m>n</m> eigenvectors of <m>A^T A</m>. The corresponding eigenvalues <m>\lambda_i</m> are ordered from largest to smallest, and the first <m>r</m> eigenvalues are non-zero.</p>

        <p>How are the eigenvectors related to the fundamental subspaces? Let's see.</p>

        <ol marker="1.">
          <li><p>Recall that <m>A^T A</m> is a <fillin width="2in"/> matrix.</p>
                    <m></m><p></p><m></m><p></p><m></m><p></p>
</li>
          <li><p>Therefore, the eigenvectors corresponding to different eigenvalues are mutually <fillin width="2in"/>.</p>
                    <m></m><p></p><m></m><p></p><m></m><p></p>
</li>
          <li><p>The singular values of <m>A</m> are the positive square roots of the eigenvalues of <fillin width="2in"/>.</p>
                    <m></m><p></p><m></m><p></p><m></m><p></p>
</li>
          <li>
            <p>So if <m>\lambda_1 \ne \lambda_2 \ne \ldots \ne \lambda_r</m> and <m>\lambda_{r+1} = 0</m>, then <m>A^T A \vec{v}_{r+1} =</m> <fillin width="2in"/>.</p>
            <p>The set of vectors</p>
            <me>
              \{\vec{v}_{r+1}, \vec{v}_{r+2}, \ldots, \vec{v}_n\}
            </me>
            <p>is an orthogonal basis for <fillin width="2in"/>.</p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>

          </li>
          <li><p>The first <m>r</m> eigenvectors form a basis for <fillin width="2in"/>.</p></li>
        </ol>
      </page>

      <page>
        <p><m>\textbf{Bases for Col}(A) \textbf{ and Null}(A^T)</m></p>

        <ol marker="1.">
          <li>
            <p>The vector <m>A \vec{v}_i</m> is a vector in <fillin width="2in"/>.</p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>
                                    <m></m><p></p><m></m><p></p><m></m><p></p>

          </li>

          <li>
            <p>The vectors <m>A \vec{v}_i</m> and <m>A \vec{v}_j</m> for <m>i \ne j</m> are orthogonal because:</p>
            <p><me>(A \vec{v}_i)^T (A \vec{v}_j) =</me></p>
            <fillin width="2in"/>
                        <m></m><p></p><m></m><p></p><m></m><p></p>
                                    <m></m><p></p><m></m><p></p><m></m><p></p>

          </li>

          <li>
            <p>If <m>r = \operatorname{rank}(A)</m>, then the set <m>\{A \vec{v}_i\}</m> for <m>i = 1, 2, \ldots, r</m> is an orthogonal basis for <fillin width="2in"/>.</p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>
                                    <m></m><p></p><m></m><p></p><m></m><p></p>


          </li>

          <li>
            <p>The vectors orthogonal to the space spanned by <m>\{A \vec{v}_i\}</m> for <m>i = 1, 2, \ldots, r</m> form an orthogonal basis for <fillin width="2in"/>.</p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>
            <m></m><p></p><m></m><p></p><m></m><p></p>

          </li>
        </ol>
      </page>

      <page>
        <p><m>\textbf{Summary}</m></p>

        <p>Suppose <m>\vec{v}</m> are the orthonormal eigenvectors for <m>A^T A</m>, and</p>

        <md>
          \vec{u}_i = \frac{1}{\sigma_i} A \vec{v}_i \quad \text{for } i \leq r = \operatorname{rank}(A), \quad \sigma_i = \|A \vec{v}_i\|.
        </md>

        <p>Then we have the following orthogonal bases for any <m>m \times n</m> real matrix <m>A</m>.</p>

        <ul>
          <li>
            <p><m>\vec{v}_1, \ldots, \vec{v}_r</m> is an orthonormal basis for Row(<m>A</m>).</p>
          </li>
          <li>
            <p><m>\vec{v}_{r+1}, \ldots, \vec{v}_n</m> is an orthonormal basis for Null(<m>A</m>).</p>
          </li>
          <li>
            <p><m>\vec{u}_1, \ldots, \vec{u}_r</m> is an orthonormal basis for Col(<m>A</m>).</p>
          </li>
        </ul>

        <p>If we need a basis for Col(<m>A^\perp</m>), we can identify any <m>m - r</m> independent non-zero vectors in Col(<m>A^\perp</m>) and then use Gram-Schmidt to orthogonalize.</p>

        <p><m>\textbf{Definition}</m></p>

        <ul>
          <li>
            <p>
              The vectors <m>\{\vec{u}_i\}</m> for <m>i \le m</m> are the <m>\textbf{left singular vectors}</m> of <m>A</m>. 
              The vectors <m>\{\vec{v}_i\}</m> for <m>i \le m</m> are the <m>\textbf{right singular vectors}</m> of <m>A</m>.
            </p>
          </li>
        </ul>
      </page>

      <page>
        <p><m>{\large \textbf {26.3 The SVD}}</m></p>
        <p><m>{\large \textbf {Theorem: Singular Value Decomposition}}</m></p>
        <ul>
          <li>
            <p>
              Suppose <m>A</m> is an <m>m \times n</m> matrix with singular values 
              <m>\sigma_1 \ge \sigma_2 \ge \cdots \ge \sigma_n</m> and <m>m \ge n</m>. 
              Then <m>A</m> has the decomposition <m>A = U \Sigma V^T</m> where
            </p>
            <me>
              \Sigma = \begin{bmatrix} D \\ 0_{m-n,n} \end{bmatrix}, \quad
              D = \begin{pmatrix}
              \sigma_1 \amp 0 \amp \ldots \amp 0 \\
              0 \amp \sigma_2 \amp \ldots \amp \vdots \\
              \vdots \amp \vdots \amp \ddots \amp \vdots \\
              0 \amp 0 \amp \ldots \amp \sigma_n
              \end{pmatrix}
            </me>
          </li>
          <li>
            <p><m>U</m> is a <m>m \times m</m> orthogonal matrix, and <m>V</m> is an <m>n \times n</m> orthogonal matrix.</p>
          </li>
        </ul>
        <p><m>\textbf {Example}</m></p>
        <p>Construct the SVD of</p>
        <me>A = 
          \begin{pmatrix}
          4 \amp -2 \\
          2 \amp -1 \\
          0 \amp 0
          \end{pmatrix}
        </me>
      </page>

      <page>
        <p><m>{\large \textbf {Additional Exercises}}</m></p>
        <p>1. Suppose</p>
        <me>A = 
          \begin{pmatrix}
          2 \amp -1 \\
          2 \amp 2
          \end{pmatrix}
        </me>
        <ul>
          <li>
            <p>Construct a unit vector <m>\vec{x}</m> for which <m>A \vec{x}</m> has maximum length.</p>
          </li>
          <li>
            <p>Compute the condition number of <m>A</m>.</p>
          </li>
        </ul>
      </page>

      <page>
        <p>2. By inspection, construct an SVD of the diagonal matrix</p>
        <me>
          \begin{pmatrix}
          2 \amp 0 \\
          0 \amp 3
          \end{pmatrix}
        </me>
        <p>The SVD of a matrix is not unique: how many different SVDs can you create from the matrix above?</p>
      </page>

      <page>
        <p>3. Indicate whether the statements are true or false.</p>
        <ol marker="(a)">
          <li>
            <p>Every matrix has a singular value decomposition.</p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>
            <m></m><p></p><m></m><p></p><m></m><p></p>

          </li>
          <li>
            <p>If <m>A</m> is symmetric, then its factorization <m>A = UDU^T</m> is also its SVD.</p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>            <m></m><p></p><m></m><p></p><m></m><p></p>


          </li>
          <li>
            <p>
              The maximum value of <m>\|A \vec{x}\|</m> subject to <m>\|\vec{x}\| = 1</m> is <m>\sigma_1</m>.
            </p>
                        <m></m><p></p><m></m><p></p><m></m><p></p>            <m></m><p></p><m></m><p></p><m></m><p></p>


          </li>
        </ol>
      </page>

    </worksheet>
